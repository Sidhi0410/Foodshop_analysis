-- what is the  successful delivery percentage of each driver?
SELECT B.DRIVER_ID,B.SUCCESSFULLY_DELIVERD,B.TOTAL_OREDRERS_TAKEN,(B.SUCCESSFULLY_DELIVERD/B.TOTAL_OREDRERS_TAKEN)*100 AS delivery_perecntage
from
(SELECT DRIVER_ID,SUM(A.CAN_PER) AS SUCCESSFULLY_DELIVERD,COUNT(A.CAN_PER) AS TOTAL_OREDRERS_TAKEN
FROM(
SELECT DRIVER_ID,CASE WHEN LOWER(CANCELLATION) LIKE '%CANCEL%' THEN 0 ELSE 1 END AS CAN_PER FROM DRIVER_ORDER) AS A
GROUP BY A.DRIVER_ID)AS B
group by B.driver_id;



